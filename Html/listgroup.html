<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Группы</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="menu">
        <ul>
            <li><a href="#">Пользователи</a></li>
            <li><a href="listgroup.html">Группы</a></li>
            <li><a href="listrole.html">Роли</a></li>
        </ul>
    </div>
    <div class="userformtable">
        <h2>Список групп</h2>
        <table class="table" name="grouptable" id="grouptable">
            <thead><tr><th>Наименование группы</th></tr></thead>
            <tbody name="grouptbody" id="grouptbody">
            </tbody>
        </table>
    </div>
    <script>
        async function loadlistgroup() {
            let url = "https://localhost:5101/api/Group/list";

            let response = await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" }
            });

            if (response.ok === true) {
                let groups = await response.json();
                let grouprows = document.getElementById("grouptbody");
                groups.forEach(group => grouprows.append(grouprow(group)));
             }
            else {
                let error = await response.json();
                console.log(error.message);
            }

        }

        function grouprow(group) {

            let tr = document.createElement("tr");
            tr.setAttribute("data-rowid", group.id);

            let nameTd = document.createElement("td");
            nameTd.append(group.name);
            tr.append(nameTd);

            /*
            let linksTd = document.createElement("td");
        
            const removeLink = document.createElement("button");
            removeLink.append("Удалить");
            removeLink.addEventListener("click", async () => await deleteGroup(group.id));
        
            linksTd.append(removeLink);
            tr.appendChild(linksTd);
            */

            return tr;
        }

        window.onload = function () {
            loadlistgroup();
            }        
    </script>
</body>
</html>