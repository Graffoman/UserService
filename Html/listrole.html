<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Роли</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="menu">
        <ul>
            <li><a href="#">Пользователи</a></li>
            <li><a href="listgroup.html">Группы</a></li>
            <li><a href="listrole.html">Роли</a></li>
        </ul>
    </div>
    <div class="userformtable">
        <h2>Список ролей</h2>
        <table class="table" name="roletable" id="roletable">
            <thead><tr><th>Наименование роли</th></tr></thead>
            <tbody name="roletbody" id="roletbody">
            </tbody>
        </table>
    </div>
    <script>
        async function loadlistrole() {
            let url = "https://localhost:5101/api/Role/list";

            let response = await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" }
            });

            if (response.ok === true) {
                let roles = await response.json();
                let rolerows = document.getElementById("roletbody");
                roles.forEach(role => rolerows.append(rolerow(role)));
            }
            else {
                let error = await response.json();
                console.log(error.message);
            }

        }

        function rolerow(role) {

            let tr = document.createElement("tr");
            tr.setAttribute("data-rowid", role.id);

            let nameTd = document.createElement("td");
            nameTd.append(role.name);
            tr.append(nameTd);

            /*
            let linksTd = document.createElement("td");

            const removeLink = document.createElement("button");
            removeLink.append("Удалить");
            removeLink.addEventListener("click", async () => await deleteRole(role.id));

            linksTd.append(removeLink);
            tr.appendChild(linksTd);
            */

            return tr;
        }

        window.onload = function () {
            loadlistrole();
        }
    </script>
</body>
</html>